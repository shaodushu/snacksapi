webpackJsonp([5],{uMyE:function(t,s,o){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var e=o("bGai"),i=o("TVG1"),a=o("lbHh"),n=o.n(a),r={name:"goods",data:function(){return{foodsList:[],listHeight:[],scrollY:0,_initHeight:null,selectedFood:{}}},components:{scroll:e.g,cartcontrol:e.a,shopcart:e.h,food:e.c},computed:{currentIndex:function(){for(var t=0,s=this.listHeight.length;t<s;t++){var o=this.listHeight[t],e=this.listHeight[t+1];if(!e||this.scrollY>=o&&this.scrollY<e)return t}return 0},selectFoods:function(){var t=[];return this.foodsList.forEach(function(s){s.foods.forEach(function(s){s.count&&t.push(s)})}),t},curShopId:function(){return this.$store.state.shopId}},watch:{curShopId:function(t){this.loadData()}},mounted:function(){this.loadData()},methods:{selectFood:function(t,s){s._constructed&&(this.selectedFood=t)},drop:function(t){var s=this;this.$nextTick(function(){s.$refs.shopcart.drop(t)})},addFood:function(t){this.drop(t)},foodsScroll:function(t){this.scrollY=Math.abs(Math.round(t.y));var s=this.$refs.menuWrapper.$el.getElementsByClassName("menu-item");this.$refs.menuWrapper.scrollToElement(s[this.currentIndex],300,0,this._initHeight)},_countHeight:function(){this._initHeight=-Math.round(this.$refs.foodsWrapper.$el.clientHeight/3);var t=this.$refs.foodsWrapper.$el.getElementsByClassName("food-list-hook"),s=this._initHeight;this.listHeight.push(s);for(var o=0,e=t.length;o<e;o++){s+=t[o].clientHeight,this.listHeight.push(s)}},selectMenu:function(t,s){if(s._constructed){var o=this.$refs.foodsWrapper.$el.getElementsByClassName("food-list-hook")[t];this.$refs.foodsWrapper.scrollToElement(o,300,0,this._initHeight)}},loadData:function(){var t=this;i.a.ajax.post("/api/client/goods/readPart",{shopId:n.a.get("shopId")}).then(function(s){t.foodsList=s.data.data,t.$nextTick(function(){t._countHeight()})}).catch(function(t){console.log(t)})}}},c={render:function(){var t=this,s=t.$createElement,o=t._self._c||s;return o("div",[o("div",{staticClass:"snacks"},[o("scroll",{ref:"menuWrapper",staticClass:"menu-wrapper",attrs:{data:t.foodsList}},[o("ul",t._l(t.foodsList,function(s,e){return o("li",{key:e,staticClass:"menu-item",class:{current:t.currentIndex===e},on:{click:function(s){t.selectMenu(e,s)}}},[o("span",{staticClass:"text"},[t._v("\n\t\t\t\t\t\t\t"+t._s(s.name)+"\n\t\t\t\t\t")])])})),t._v(" "),o("div",{staticClass:"loading-wrapper"})]),t._v(" "),o("scroll",{ref:"foodsWrapper",staticClass:"foods-wrapper",attrs:{data:t.foodsList,probeType:3,listenScroll:!0},on:{scroll:t.foodsScroll}},[o("ul",t._l(t.foodsList,function(s,e){return o("li",{key:e,staticClass:"food-list food-list-hook"},[o("h1",{staticClass:"title"},[t._v(t._s(s.name))]),t._v(" "),o("ul",t._l(s.foods,function(s,e){return o("li",{key:e,staticClass:"food-item",on:{click:function(o){t.selectFood(s,o)}}},[o("div",{staticClass:"icon"},[o("img",{attrs:{src:s.image,width:"57",height:"57"}})]),t._v(" "),o("div",{staticClass:"content"},[o("h2",{staticClass:"name"},[t._v(t._s(s.name))]),t._v(" "),o("p",{staticClass:"desc"},[t._v(t._s(s.description))]),t._v(" "),o("div",{staticClass:"extra"},[o("span",{staticClass:"count"},[t._v("月售"+t._s(s.sellCount)+"份")]),t._v(" "),o("span",[t._v("好评率"+t._s(s.rating))])]),t._v(" "),o("div",{staticClass:"cartControl-wrapper"},[o("cartcontrol",{attrs:{food:s},on:{add:t.addFood}})],1),t._v(" "),o("div",{staticClass:"price"},[o("span",{staticClass:"now"},[t._v("¥"+t._s(s.price))]),o("span",{directives:[{name:"show",rawName:"v-show",value:s.oldPrice,expression:"food.oldPrice"}],staticClass:"old"},[t._v("¥"+t._s(s.oldPrice))])])])])}))])})),t._v(" "),o("div",{staticClass:"loading-wrapper"})]),t._v(" "),o("shopcart",{ref:"shopcart",attrs:{"select-foods":t.selectFoods}})],1)])},staticRenderFns:[]};var l=o("VU/8")(r,c,!1,function(t){o("vdr6")},"data-v-5ce06c28",null);s.default=l.exports},vdr6:function(t,s){}});
//# sourceMappingURL=5.c71a9b5fd68791985e51.js.map