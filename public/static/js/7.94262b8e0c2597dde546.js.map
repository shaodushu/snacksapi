{"version":3,"sources":["webpack:///src/views/map/index.vue","webpack:///./src/views/map/index.vue?1e63","webpack:///./src/views/map/index.vue"],"names":["map","data","AMapUI","AMap","methods","initMap","_this","this","window","loadUI","PositionPicker","Map","zoom","center","plugin","gConfig","enableHighAccuracy","timeout","maximumAge","convert","showButton","buttonPosition","buttonOffset","Pixel","showMarker","showCircle","panToLocation","zoomToAccuracy","geolocation","Geolocation","addControl","getCurrentPosition","event","addListener","getMarker","position","getLng","getLat","err","console","log","lng","lat","radius","_this2","util","ajax","post","then","res","SimpleMarker","forEach","cur","marker","iconStyle","src","image","style","width","height","border-radius","border","offset","showPositionPoint","longitude","latitude","zIndex","animation","extData","id","e","$router","push","name","params","target","$store","commit","catch","created","_this3","asyncToGenerator_default","regenerator_default","a","mark","_callee","wrap","_context","prev","next","Object","remoteLoad","stop","views_map","render","_h","$createElement","_self","_c","staticStyle","attrs","staticRenderFns","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"gMAMAA,GACAC,KADA,WAEA,OACAC,OAAA,KACAC,KAAA,KACAH,IAAA,OAGAI,SAEAC,QAFA,WAEA,IAAAC,EAAAC,KAEAL,EAAAK,KAAAL,OAAAM,OAAAN,OACAC,EAAAI,KAAAJ,KAAAK,OAAAL,KACAD,EAAAO,QAAA,gCAAAC,GAMAJ,EAAAN,IAAA,IAAAG,EAAAQ,IAAA,aAJAC,KAAA,GACAC,QAAA,sBAMAV,EAAAW,QAAA,+BAEA,IAAAC,GACAC,oBAAA,EACAC,QAAA,IACAC,WAAA,EACAC,SAAA,EACAC,YAAA,EACAC,eAAA,KACAC,aAAA,IAAAnB,EAAAoB,MAAA,OACAC,YAAA,EACAC,YAAA,EACAC,eAAA,EACAC,gBAAA,GAEAC,EAAA,IAAAzB,EAAA0B,YAAAd,GACAT,EAAAN,IAAA8B,WAAAF,GACAA,EAAAG,qBAEA5B,EAAA6B,MAAAC,YAAAL,EAAA,oBAAA3B,GACAK,EAAA4B,UACAjC,EAAAkC,SAAAC,SACAnC,EAAAkC,SAAAE,SACA,OAIAlC,EAAA6B,MAAAC,YAAAL,EAAA,iBAAAU,GACAC,QAAAC,IAAAF,UAMAJ,UAjDA,SAiDAO,EAAAC,EAAAC,GAAA,IAAAC,EAAArC,KACAL,EAAAK,KAAAL,OAAAM,OAAAN,OACAC,EAAAI,KAAAJ,KAAAK,OAAAL,KACA0C,EAAA,EAAAC,KACAC,KAAA,2BACAN,MACAC,MACAC,WAEAK,KAAA,SAAAC,GAEA/C,EAAAO,QAAA,iCAAAyC,GACAD,EAAAhD,UAAAkD,QAAA,SAAAC,GACA,IAAAC,EAAA,IAAAH,GAEAI,WACAC,IAAAH,EAAAI,MACAC,OACAC,MAAA,OACAC,OAAA,OACAC,gBAAA,OACAC,OAAA,sBAKAC,OAAA,IAAA3D,EAAAoB,OAAA,QACAvB,IAAA4C,EAAA5C,IACA+D,mBAAA,EACA5B,UAAAiB,EAAAY,UAAAZ,EAAAa,UACAC,OAAA,IACAC,UAAA,wBAEAd,EAAAe,SACAC,GAAAjB,EAAAiB,IAEAlE,EAAA6B,MAAAC,YAAAoB,EAAA,sBAAAiB,GACA1B,EAAA2B,QAAAC,MACAC,KAAA,OACAC,QACAL,GAAAC,EAAAK,OAAAP,QAAAC,MAGAzB,EAAAgC,OAAAC,OAAA,eAAAP,EAAAK,OAAAP,QAAAC,YAQAS,MAAA,SAAAxC,GAAA,OAAAC,QAAAC,IAAAF,OAGAyC,QA/GA,WA+GA,IAAAC,EAAAzE,KAAA,OAAA0E,IAAAC,EAAAC,EAAAC,KAAA,SAAAC,IAAA,OAAAH,EAAAC,EAAAG,KAAA,SAAAC,GAAA,cAAAA,EAAAC,KAAAD,EAAAE,MAAA,WAEAjF,OAAAL,OAAAK,OAAAN,OAFA,CAAAqF,EAAAE,KAAA,QAGAT,EAAA3E,UAHAkF,EAAAE,KAAA,sBAAAF,EAAAE,KAAA,EAMAC,OAAAC,EAAA,EAAAD,CACA,6EAPA,cAAAH,EAAAE,KAAA,EASAC,OAAAC,EAAA,EAAAD,CAAA,0CATA,OAUAV,EAAA3E,UAVA,wBAAAkF,EAAAK,SAAAP,EAAAL,KAAAC,KClHAY,GADiBC,OAFjB,WAA0B,IAAaC,EAAbxF,KAAayF,eAAkD,OAA/DzF,KAAuC0F,MAAAC,IAAAH,GAAwB,OAAiBI,aAAazC,MAAA,OAAAC,OAAA,SAAgCyC,OAAQ/B,GAAA,gBAE9IgC,oBCCjB,IAcAC,EAdAC,EAAA,OAcAC,CACAxG,EACA6F,GATA,EAVA,SAAAY,GACAF,EAAA,SAaA,kBAEA,MAUAG,EAAA,QAAAJ,EAAA","file":"static/js/7.94262b8e0c2597dde546.js","sourcesContent":["<template>\r\n  <div id=\"container\" style=\"width:100%; height:100vh\"></div>\r\n</template>\r\n<script>\r\nimport remoteLoad from \"@/libs/remoteLoad\";\r\nimport Util from \"@/libs/util\";\r\nexport default {\r\n  data() {\r\n    return {\r\n      AMapUI: null,\r\n      AMap: null,\r\n      map: null\r\n    };\r\n  },\r\n  methods: {\r\n    // 实例化地图\r\n    initMap() {\r\n      // 加载PositionPicker，loadUI的路径参数为模块名中 'ui/' 之后的部分\r\n      let AMapUI = (this.AMapUI = window.AMapUI);\r\n      let AMap = (this.AMap = window.AMap);\r\n      AMapUI.loadUI([\"misc/PositionPicker\"], PositionPicker => {\r\n        let mapConfig = {\r\n          zoom: 14,\r\n          center: [121.82194, 39.10041]\r\n        };\r\n\r\n        this.map = new AMap.Map(\"container\", mapConfig);\r\n\r\n        // 启用定位\r\n        AMap.plugin([\"AMap.Geolocation\"], () => {\r\n          //debugger\r\n          let gConfig = {\r\n            enableHighAccuracy: true, //是否使用高精度定位，默认:true\r\n            timeout: 10000, //超过10秒后停止定位，默认：无穷大\r\n            maximumAge: 0, //定位结果缓存0毫秒，默认：0\r\n            convert: true, //自动偏移坐标，偏移后的坐标为高德坐标，默认：true\r\n            showButton: true, //显示定位按钮，默认：true\r\n            buttonPosition: \"LB\", //定位按钮停靠位置，默认：'LB'，左下角\r\n            buttonOffset: new AMap.Pixel(10, 20), //定位按钮与设置的停靠位置的偏移量，默认：Pixel(10, 20)\r\n            showMarker: true, //定位成功后在定位到的位置显示点标记，默认：true\r\n            showCircle: false, //定位成功后用圆圈表示定位精度范围，默认：true\r\n            panToLocation: true, //定位成功后将定位到的位置作为地图中心点，默认：true\r\n            zoomToAccuracy: true //定位成功后调整地图视野范围使定位位置及精度范围视野内可见，默认：false\r\n          };\r\n          let geolocation = new AMap.Geolocation(gConfig);\r\n          this.map.addControl(geolocation);\r\n          geolocation.getCurrentPosition();\r\n          //返回定位信息\r\n          AMap.event.addListener(geolocation, \"complete\", data => {\r\n            this.getMarker(\r\n              data.position.getLng(),\r\n              data.position.getLat(),\r\n              5000\r\n            );\r\n          });\r\n          //返回定位出错信息\r\n          AMap.event.addListener(geolocation, \"error\", err => {\r\n            console.log(err);\r\n          });\r\n        });\r\n        // this.getMarker(121.82194, 39.10041, 5000);\r\n      });\r\n    },\r\n    getMarker(lng, lat, radius) {\r\n      let AMapUI = (this.AMapUI = window.AMapUI);\r\n      let AMap = (this.AMap = window.AMap);\r\n      Util.ajax\r\n        .post(\"/api/client/shop/circum\", {\r\n          lng: lng,\r\n          lat: lat,\r\n          radius: radius\r\n        })\r\n        .then(res => {\r\n          //启用SimpleMarker\r\n          AMapUI.loadUI([\"overlay/SimpleMarker\"], SimpleMarker => {\r\n            res.data.data.forEach(cur => {\r\n              let marker = new SimpleMarker({\r\n                //自定义图标节点(img)的属性\r\n                iconStyle: {\r\n                  src: cur.image,\r\n                  style: {\r\n                    width: \"45px\",\r\n                    height: \"45px\",\r\n                    \"border-radius\": \"100%\",\r\n                    border: \"3px solid #5cadff\"\r\n                  }\r\n                },\r\n\r\n                //设置基点偏移\r\n                offset: new AMap.Pixel(-10, -30),\r\n                map: this.map,\r\n                showPositionPoint: false,\r\n                position: [cur.longitude, cur.latitude],\r\n                zIndex: 200,\r\n                animation: \"AMAP_ANIMATION_DROP\",\r\n              });\r\n              marker.extData={\r\n                id:cur.id\r\n              }\r\n              AMap.event.addListener(marker, \"touchstart\", e => {\r\n                this.$router.push({\r\n                  name:'shop',\r\n                  params:{\r\n                    id:e.target.extData.id,\r\n                  }\r\n                })\r\n                this.$store.commit('changeShopId',e.target.extData.id)\r\n                \r\n              });\r\n            });\r\n            //让自适应显示多个点标记\r\n            //this.map.setFitView().getCenter();\r\n          });\r\n        })\r\n        .catch(err => console.log(err));\r\n    }\r\n  },\r\n  async created() {\r\n    // 已载入高德地图API，则直接初始化地图\r\n    if (window.AMap && window.AMapUI) {\r\n      this.initMap();\r\n      // 未载入高德地图API，则先载入API再初始化\r\n    } else {\r\n      await remoteLoad(\r\n        \"https://webapi.amap.com/maps?v=1.4.6&key=c42fafbe4ea7bdba7423b409392a4a2b\"\r\n      );\r\n      await remoteLoad(\"https://webapi.amap.com/ui/1.0/main.js\");\r\n      this.initMap();\r\n    }\r\n  }\r\n};\r\n</script>\r\n<style lang=\"sass\" scoped>\r\n\r\n</style>\r\n\n\n\n// WEBPACK FOOTER //\n// src/views/map/index.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticStyle:{\"width\":\"100%\",\"height\":\"100vh\"},attrs:{\"id\":\"container\"}})}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-0a10d834\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/views/map/index.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-0a10d834\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!sass-loader?{\\\"indentedSyntax\\\":true,\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./index.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./index.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./index.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-0a10d834\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./index.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-0a10d834\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/views/map/index.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}