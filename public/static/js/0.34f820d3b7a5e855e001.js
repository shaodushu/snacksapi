webpackJsonp([0],{ElUQ:function(t,s){},uMyE:function(t,s,o){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var e=o("bGai"),i={name:"goods",data:function(){return{foodsList:[],listHeight:[],scrollY:0,_initHeight:null}},components:{scroll:e.c,cartcontrol:e.a,shopcart:e.d},computed:{currentIndex:function(){for(var t=0,s=this.listHeight.length;t<s;t++){var o=this.listHeight[t],e=this.listHeight[t+1];if(!e||this.scrollY>=o&&this.scrollY<e)return t}return 0},selectFoods:function(){var t=[];return this.foodsList.forEach(function(s){s.foods.forEach(function(s){s.count&&t.push(s)})}),t}},created:function(){this.loadData()},methods:{drop:function(t){var s=this;this.$nextTick(function(){s.$refs.shopcart.drop(t)})},addFood:function(t){this.drop(t)},foodsScroll:function(t){this.scrollY=Math.abs(Math.round(t.y));var s=this.$refs.menuWrapper.$el.getElementsByClassName("menu-item");this.$refs.menuWrapper.scrollToElement(s[this.currentIndex],300,0,this._initHeight)},_countHeight:function(){this._initHeight=-Math.round(this.$refs.foodsWrapper.$el.clientHeight/3);var t=this.$refs.foodsWrapper.$el.getElementsByClassName("food-list-hook"),s=this._initHeight;this.listHeight.push(s);for(var o=0,e=t.length;o<e;o++){s+=t[o].clientHeight,this.listHeight.push(s)}},selectMenu:function(t,s){if(s._constructed){var o=this.$refs.foodsWrapper.$el.getElementsByClassName("food-list-hook")[t];this.$refs.foodsWrapper.scrollToElement(o,300,0,this._initHeight)}},loadData:function(){var t=this;this.axios.get("/api/goods").then(function(s){t.foodsList=s.data.data.concat(t.foodsList),t.$nextTick(function(){t._countHeight()})}).catch(function(t){console.log(t)})}}},a={render:function(){var t=this,s=t.$createElement,o=t._self._c||s;return o("div",{staticClass:"snacks"},[o("scroll",{ref:"menuWrapper",staticClass:"menu-wrapper",attrs:{data:t.foodsList}},[o("ul",t._l(t.foodsList,function(s,e){return o("li",{key:e,staticClass:"menu-item",class:{current:t.currentIndex===e},on:{click:function(s){t.selectMenu(e,s)}}},[o("span",{staticClass:"text"},[t._v("\n\t\t\t\t\t\t\t"+t._s(s.name)+"\n\t\t\t\t\t")])])})),t._v(" "),o("div",{staticClass:"loading-wrapper"})]),t._v(" "),o("scroll",{ref:"foodsWrapper",staticClass:"foods-wrapper",attrs:{data:t.foodsList,probeType:3,listenScroll:!0},on:{scroll:t.foodsScroll}},[o("ul",t._l(t.foodsList,function(s,e){return o("li",{key:e,staticClass:"food-list food-list-hook"},[o("h1",{staticClass:"title"},[t._v(t._s(s.name))]),t._v(" "),o("ul",t._l(s.foods,function(s,e){return o("li",{key:e,staticClass:"food-item"},[o("div",{staticClass:"icon"},[o("img",{attrs:{src:s.image,width:"57",height:"57"}})]),t._v(" "),o("div",{staticClass:"content"},[o("h2",{staticClass:"name"},[t._v(t._s(s.name))]),t._v(" "),o("p",{staticClass:"desc"},[t._v(t._s(s.description))]),t._v(" "),o("div",{staticClass:"extra"},[o("span",{staticClass:"count"},[t._v("月售"+t._s(s.sellCount)+"份")]),t._v(" "),o("span",[t._v("好评率"+t._s(s.rating))])]),t._v(" "),o("div",{staticClass:"cartControl-wrapper"},[o("cartcontrol",{attrs:{food:s},on:{add:t.addFood}})],1),t._v(" "),o("div",{staticClass:"price"},[o("span",{staticClass:"now"},[t._v("¥"+t._s(s.price))]),o("span",{directives:[{name:"show",rawName:"v-show",value:s.oldPrice,expression:"food.oldPrice"}],staticClass:"old"},[t._v("¥"+t._s(s.oldPrice))])])])])}))])})),t._v(" "),o("div",{staticClass:"loading-wrapper"})]),t._v(" "),o("shopcart",{ref:"shopcart",attrs:{"select-foods":t.selectFoods}})],1)},staticRenderFns:[]};var n=o("VU/8")(i,a,!1,function(t){o("ElUQ")},"data-v-6db1b5c4",null);s.default=n.exports}});
//# sourceMappingURL=0.34f820d3b7a5e855e001.js.map